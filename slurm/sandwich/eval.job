#!/bin/bash

#SBATCH --partition=gpu_titanrtx
#SBATCH --gres=gpu:1
#SBATCH --job-name=SW_EVAL
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=3
#SBATCH --time=06:00:00
#SBATCH --mem=32000M
#SBATCH --output=slurm/outputs/sandwich_eval_%A.out

module purge
module load 2022
module load Miniconda3/4.12.0

source activate claficle

# variable for datadir. Need to use scratch dir
datadir=$TMPDIR/gstarace/claficle/data

# will only create this directory if it doesn't exist
mkdir -p $datadir

# copy the data to the scratch dir
rsync -avz $HOME/claficle/data/ $datadir

srun python -u claficle/run/eval.py model=sandwich benchmark.data_dir=$datadir
